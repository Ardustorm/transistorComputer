* D:\transistorComputer\CMOS\Counter.asc
XX1 NS[0] NS[1] NS[2] VDD CNT[0] CNT[1] CNT[2] CLK NC_01 NC_01 NC_01 reg[3]
XX2 CNT[0] CNT[1] CNT[2] VDD NS[0] NS[1] NS[2] counter_ns

* block symbol definitions
.subckt reg[3] D[0] D[1] D[2] VDD Q[0] Q[1] Q[2] CLK !Q[0] !Q[1] !Q[2]
XX2 D[1] VDD Q[1] CLK !Q[1] dff
XX1 D[0] VDD Q[0] CLK !Q[0] dff
XX3 D[2] VDD Q[2] CLK !Q[2] dff
.ends reg[3]

.subckt counter_ns PS[0] PS[1] PS[2] VDD NS[0] NS[1] NS[2]
XX1 PS[0] VDD N001 gate_not
XX4 N001 VDD NS[0] gate_delay params: Speed=.001
XX5 N002 VDD NS[1] gate_delay
XX6 N003 VDD NS[2] gate_delay
XX2 PS[0] PS[1] N002 VDD gate_xor
XX3 PS[1] PS[2] N003 VDD gate_xor
.ends counter_ns

.subckt dff D VDD Q CLK !Q
XX2 D VDD N004 gate_not_dff
XX1 CLK VDD N002 gate_not_slow
XX3 D N002 N001 VDD CLK gate_nand_dff[3]
XX4 N002 N004 N003 VDD CLK gate_nand_dff[3]
XX5 N001 !Q Q VDD gate_nand_dff
XX6 N003 Q !Q VDD gate_nand_dff
.ends dff

.subckt gate_not A VDD !A
M1 !A A 0 0 RIT4007N7
M2 !A A VDD VDD RIT4007P7
.inc CD4007.mod
.ends gate_not

.subckt gate_delay A VDD OUT
M1 N001 A 0 0 myNMOS w=myNW L=myNL
M2 N001 A VDD VDD myPMOS W=myPW L=myPL
M3 Out N001 0 0 myNMOS w=myNW L=myNL
M4 Out N001 VDD VDD myPMOS W=myPW L=myPL
.inc Mod_W2017N.mod
.param myPW=2u*sqrt(Speed)
.param myPL=500u/sqrt(Speed)
.param myNW=.1u*sqrt(Speed)
.param myNL=2500u/sqrt(Speed)
.param Speed=1
.ends gate_delay

.subckt gate_xor A B Out VDD
M1 Out A N003 N003 RIT4007N7
M2 Out N002 P001 P001 RIT4007P7
M3 Out N001 P002 P002 RIT4007P7
M4 N003 N001 0 0 RIT4007N7
M5 N003 B 0 0 RIT4007N7
M6 Out N002 N003 N003 RIT4007N7
M7 P002 B VDD VDD RIT4007P7
M8 P001 A VDD VDD RIT4007P7
XX1 A VDD N001 gate_not
XX4 B VDD N002 gate_not
.inc CD4007.mod
.ends gate_xor

.subckt gate_not_dff A VDD !A
M1 !A A 0 0 myNMOS w=.3u L=100u
M2 !A A VDD VDD myPMOS W=2u L=100u
.model myNMOS NMOS (LEVEL=7 TOX=8e-9 U0 = 1300
+CGSO=3.4E-10 CGDO=3.4E-10 CJ=6.8e-4 CJSW=1.26e-10
+MJ=0.5 MJSW=0.5 CGBO=5.75E-10 RSH=33.8)
.model myPMOS PMOS (LEVEL=7 TOX=8e-9 CGDO=5.3752E-11
+U0= 440 CGSO=5.3752E-11 CGBO=3.3650E-10 CJ=4.8447E-04
+MJ=0.5027 CJSW=1.6457E-10 MJSW=0.217168 RSH=29.8)
.inc Mod_W2017N.mod
.ends gate_not_dff

.subckt gate_not_slow A VDD !A
M1 !A A 0 0 myNMOS w=.1u L=500u
M2 !A A VDD VDD myPMOS W=2u L=100u
.inc Mod_W2017N.mod
.ends gate_not_slow

.subckt gate_nand_dff[3] A C Out VDD B
M1 Out A N001 N001 myNMOS W=myNW L=myNL
M4 Out A VDD VDD myPMOS W=myPW L=myPL
M5 Out B VDD VDD myPMOS W=myPW L=myPL
M2 N001 B P001 P001 myNMOS W=myNW L=myNL
M§3 P001 C 0 0 myNMOS W=myNW L=myNL
M3 Out C VDD VDD myPMOS W=myPW L=myPL
.inc Mod_W2017N.mod
.param myPW=100u
.param myPL=10u
.param myNW=100u
.param myNL=10u
.ends gate_nand_dff[3]

.subckt gate_nand_dff A B Out VDD
M1 Out A N001 N001 myNMOS W=myNW L=myNL
M2 Out A VDD VDD myPMOS W=myPW L=myPL
M3 Out B VDD VDD myPMOS W=myPW L=myPL
M4 N001 B 0 0 myNMOS W=myNW L=myNL
.inc Mod_W2017N.mod
.param myPW=100u
.param myPL=10u
.param myNW=100u
.param myNL=10u
.ends gate_nand_dff

.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\john\Documents\LTspiceXVII\lib\cmp\standard.mos
.backanno
.end
